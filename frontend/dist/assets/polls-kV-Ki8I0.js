import{a4 as S,h as c,a5 as l}from"./index-CwG20VuD.js";const x=S("polls",()=>{const u=c([]),n=c(null),i=c([]),f=c([]),a=c(!1);async function p(e={}){a.value=!0;try{const r=await l.get("/api/polls",{params:e});return u.value=r.data.polls||[],r.data}catch(r){throw console.error("Error fetching polls:",r),r}finally{a.value=!1}}async function s(e){a.value=!0;try{const r=await l.get(`/api/polls/${e}`);return n.value=r.data.poll,r.data}catch(r){throw console.error("Error fetching poll:",r),r}finally{a.value=!1}}async function v(e){a.value=!0;try{const r=await l.post("/api/polls",e);return u.value.unshift(r.data),r.data}catch(r){throw console.error("Error creating poll:",r),r}finally{a.value=!1}}async function y(e,r){var t;a.value=!0;try{const o=await l.put(`/api/polls/${e}`,r);return((t=n.value)==null?void 0:t.id)===e&&(n.value={...n.value,...o.data}),o.data}catch(o){throw console.error("Error updating poll:",o),o}finally{a.value=!1}}async function h(e){a.value=!0;try{return await l.delete(`/api/polls/${e}`),u.value=u.value.filter(r=>r.id!==e),n.value=null,!0}catch(r){throw console.error("Error deleting poll:",r),r}finally{a.value=!1}}async function d(e,r){var t;a.value=!0;try{const o=await l.post(`/api/polls/${e}/final`,{date_option_id:r});return((t=n.value)==null?void 0:t.id)===e&&(n.value={...n.value,final_date:r}),o.data}catch(o){throw console.error("Error setting final date:",o),o}finally{a.value=!1}}async function w(e,r,t=null){a.value=!0;try{const o=t?{votes:r,user_name:t}:{votes:r},C=await l.post(`/api/polls/${e}/vote`,o);return await s(e),C.data}catch(o){throw console.error("Error voting:",o),o}finally{a.value=!1}}async function g(e,r,t){a.value=!0;try{const o=await l.put(`/api/polls/${e}/votes/${r}`,{response:t});return await s(e),o.data}catch(o){throw console.error("Error updating vote:",o),o}finally{a.value=!1}}async function m(e,r){a.value=!0;try{return await l.delete(`/api/polls/${e}/votes/${r}`),await s(e),!0}catch(t){throw console.error("Error deleting vote:",t),t}finally{a.value=!1}}async function E(e,r){a.value=!0;try{const t=await l.post(`/api/polls/${e}/comments`,{content:r});return await s(e),t.data}catch(t){throw console.error("Error adding comment:",t),t}finally{a.value=!1}}async function $(e,r){a.value=!0;try{return await l.delete(`/api/polls/${e}/comments/${r}`),await s(e),!0}catch(t){throw console.error("Error deleting comment:",t),t}finally{a.value=!1}}async function P(){a.value=!0;try{const e=await l.get("/api/user/polls");return i.value=e.data.polls||[],e.data}catch(e){throw console.error("Error fetching user polls:",e),e}finally{a.value=!1}}async function V(){a.value=!0;try{const e=await l.get("/api/user/votes");return f.value=e.data.votes||[],e.data}catch(e){throw console.error("Error fetching user votes:",e),e}finally{a.value=!1}}function _(){n.value=null}return{polls:u,currentPoll:n,userPolls:i,userVotes:f,loading:a,fetchPolls:p,fetchPoll:s,createPoll:v,updatePoll:y,deletePoll:h,setFinalDate:d,vote:w,updateVote:g,deleteVote:m,addComment:E,deleteComment:$,fetchUserPolls:P,fetchUserVotes:V,clearCurrentPoll:_}});export{x as u};
