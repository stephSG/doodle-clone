import{a2 as _,h as c,a3 as l}from"./index-BzyAT-xv.js";const U=_("polls",()=>{const u=c([]),n=c(null),i=c([]),f=c([]),t=c(!1);async function p(e={}){t.value=!0;try{const r=await l.get("/api/polls",{params:e});return u.value=r.data.polls||[],r.data}catch(r){throw console.error("Error fetching polls:",r),r}finally{t.value=!1}}async function s(e){t.value=!0;try{const r=await l.get(`/api/polls/${e}`);return n.value=r.data.poll,r.data}catch(r){throw console.error("Error fetching poll:",r),r}finally{t.value=!1}}async function v(e){t.value=!0;try{const r=await l.post("/api/polls",e);return u.value.unshift(r.data),r.data}catch(r){throw console.error("Error creating poll:",r),r}finally{t.value=!1}}async function y(e,r){var a;t.value=!0;try{const o=await l.put(`/api/polls/${e}`,r);return((a=n.value)==null?void 0:a.id)===e&&(n.value={...n.value,...o.data}),o.data}catch(o){throw console.error("Error updating poll:",o),o}finally{t.value=!1}}async function h(e){t.value=!0;try{return await l.delete(`/api/polls/${e}`),u.value=u.value.filter(r=>r.id!==e),n.value=null,!0}catch(r){throw console.error("Error deleting poll:",r),r}finally{t.value=!1}}async function d(e,r){var a;t.value=!0;try{const o=await l.post(`/api/polls/${e}/final`,{date_option_id:r});return((a=n.value)==null?void 0:a.id)===e&&(n.value={...n.value,final_date:r}),o.data}catch(o){throw console.error("Error setting final date:",o),o}finally{t.value=!1}}async function w(e,r){t.value=!0;try{const a=await l.post(`/api/polls/${e}/votes`,{votes:r});return await s(e),a.data}catch(a){throw console.error("Error voting:",a),a}finally{t.value=!1}}async function g(e,r,a){t.value=!0;try{const o=await l.put(`/api/polls/${e}/votes/${r}`,{response:a});return await s(e),o.data}catch(o){throw console.error("Error updating vote:",o),o}finally{t.value=!1}}async function m(e,r){t.value=!0;try{return await l.delete(`/api/polls/${e}/votes/${r}`),await s(e),!0}catch(a){throw console.error("Error deleting vote:",a),a}finally{t.value=!1}}async function E(e,r){t.value=!0;try{const a=await l.post(`/api/polls/${e}/comments`,{content:r});return await s(e),a.data}catch(a){throw console.error("Error adding comment:",a),a}finally{t.value=!1}}async function $(e,r){t.value=!0;try{return await l.delete(`/api/polls/${e}/comments/${r}`),await s(e),!0}catch(a){throw console.error("Error deleting comment:",a),a}finally{t.value=!1}}async function P(){t.value=!0;try{const e=await l.get("/api/user/polls");return i.value=e.data.polls||[],e.data}catch(e){throw console.error("Error fetching user polls:",e),e}finally{t.value=!1}}async function V(){t.value=!0;try{const e=await l.get("/api/user/votes");return f.value=e.data.votes||[],e.data}catch(e){throw console.error("Error fetching user votes:",e),e}finally{t.value=!1}}function C(){n.value=null}return{polls:u,currentPoll:n,userPolls:i,userVotes:f,loading:t,fetchPolls:p,fetchPoll:s,createPoll:v,updatePoll:y,deletePoll:h,setFinalDate:d,vote:w,updateVote:g,deleteVote:m,addComment:E,deleteComment:$,fetchUserPolls:P,fetchUserVotes:V,clearCurrentPoll:C}});export{U as u};
