import{g as $,a as l,c as n,b as t,d as f,w as h,e as v,t as d,j as b,i as C,o as j,F as w,r as _,h as y,n as E,P as B}from"./index-BzyAT-xv.js";import{u as D}from"./polls-DhwkvhO5.js";const z={class:"poll-card card"},A={class:"card-body"},F={class:"card-title"},N={key:0,class:"text-sm text-base-content/70 line-clamp-2"},S={class:"flex flex-wrap gap-2 mt-2"},U={key:0,class:"badge badge-ghost"},Y={key:1,class:"badge badge-outline"},L={key:2,class:"badge badge-success"},T={class:"flex items-center justify-between mt-4"},q={class:"flex items-center gap-2 text-sm text-base-content/60"},H={class:"avatar placeholder"},O={class:"bg-neutral text-neutral-content rounded-full w-6"},R={class:"text-xs"},G={key:0,class:"dropdown dropdown-end"},I={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-32"},J={key:1,class:"mt-3"},K={class:"flex justify-between text-xs mb-1"},Q=["value"],W={__name:"PollCard",props:{poll:{type:Object,required:!0},showActions:{type:Boolean,default:!1}},emits:["edit","delete"],setup(s){function g(u){const i=new Date(u)-new Date;return i<0?"Expired":i<864e5?"Expires today":i<1728e5?"Expires tomorrow":`Expires in ${Math.ceil(i/864e5)} days`}return(u,o)=>{var i,p,m;const c=$("router-link");return l(),n("div",z,[t("div",A,[t("h3",F,[f(c,{to:`/poll/${s.poll.id}`,class:"hover:text-primary transition-colors"},{default:h(()=>[v(d(s.poll.title),1)]),_:1},8,["to"])]),s.poll.description?(l(),n("p",N,d(s.poll.description),1)):b("",!0),t("div",S,[s.poll.location?(l(),n("div",U,[o[2]||(o[2]=t("svg",{class:"w-3 h-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})],-1)),v(" "+d(s.poll.location),1)])):b("",!0),s.poll.expires_at?(l(),n("div",Y,[o[3]||(o[3]=t("svg",{class:"w-3 h-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),v(" "+d(g(s.poll.expires_at)),1)])):b("",!0),s.poll.final_date?(l(),n("div",L," âœ“ Final date selected ")):b("",!0)]),t("div",T,[t("div",q,[t("div",H,[t("div",O,[t("span",R,d(((p=(i=s.poll.creator)==null?void 0:i.name)==null?void 0:p.charAt(0))||"?"),1)])]),t("span",null,d(((m=s.poll.creator)==null?void 0:m.name)||"Unknown"),1)]),s.showActions?(l(),n("div",G,[o[4]||(o[4]=t("div",{tabindex:"0",role:"button",class:"btn btn-ghost btn-sm btn-circle"},[t("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})])],-1)),t("ul",I,[t("li",null,[t("a",{onClick:o[0]||(o[0]=k=>u.$emit("edit",s.poll))},"Edit")]),t("li",null,[t("a",{onClick:o[1]||(o[1]=k=>u.$emit("delete",s.poll)),class:"text-error"},"Delete")])])])):(l(),C(c,{key:1,to:`/poll/${s.poll.id}`,class:"btn btn-primary btn-sm"},{default:h(()=>[...o[5]||(o[5]=[v(" View Poll ",-1)])]),_:1},8,["to"]))]),s.poll.participant_count!==void 0?(l(),n("div",J,[t("div",K,[t("span",null,d(s.poll.participant_count)+" participant"+d(s.poll.participant_count!==1?"s":""),1)]),t("progress",{class:"progress progress-primary w-full",value:Math.min(s.poll.participant_count*10,100),max:"100"},null,8,Q)])):b("",!0)])])}}},X={class:"space-y-8"},Z={class:"stats stats-vertical lg:stats-horizontal shadow w-full"},tt={class:"stat"},et={class:"stat-value text-primary"},st={class:"stat"},lt={class:"stat-value text-secondary"},ot={role:"tablist",class:"tabs tabs-bordered"},nt=["checked"],at={role:"tabpanel",class:"tab-content pt-4"},rt={key:0,class:"flex justify-center"},it={key:1,class:"text-center py-12"},dt={key:2,class:"grid gap-4 md:grid-cols-2"},ct=["checked"],ut={role:"tabpanel",class:"tab-content pt-4"},pt={key:0,class:"flex justify-center"},vt={key:1,class:"text-center py-12"},bt={key:2,class:"overflow-x-auto"},ht={class:"table"},mt={key:0,class:"text-sm text-base-content/70"},gt={__name:"DashboardView",setup(s){const g=E(),u=D(),o=y("polls"),c=y(!1),i=y([]),p=y([]);async function m(){c.value=!0;try{const a=await u.fetchUserPolls();i.value=a.polls||[]}catch(a){console.error("Error loading polls:",a)}finally{c.value=!1}}async function k(){c.value=!0;try{const a=await u.fetchUserVotes();p.value=a.votes||[]}catch(a){console.error("Error loading votes:",a)}finally{c.value=!1}}function M(a){g.push(`/poll/${a.id}/edit`)}async function P(a){if(confirm(`Are you sure you want to delete "${a.title}"?`))try{await u.deletePoll(a.id),i.value=i.value.filter(e=>e.id!==a.id)}catch(e){console.error("Error deleting poll:",e)}}function V(a){return new Date(a).toLocaleString()}return j(()=>{m(),k()}),(a,e)=>{const x=$("router-link");return l(),n("div",X,[e[13]||(e[13]=t("h1",{class:"text-3xl font-bold"},"Dashboard",-1)),t("div",Z,[t("div",tt,[e[2]||(e[2]=t("div",{class:"stat-figure text-primary"},[t("svg",{class:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1)),e[3]||(e[3]=t("div",{class:"stat-title"},"Polls Created",-1)),t("div",et,d(i.value.length),1)]),t("div",st,[e[4]||(e[4]=t("div",{class:"stat-figure text-secondary"},[t("svg",{class:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[5]||(e[5]=t("div",{class:"stat-title"},"Votes Cast",-1)),t("div",lt,d(p.value.length),1)])]),t("div",ot,[t("input",{type:"radio",name:"dashboard_tabs",role:"tab",class:"tab","aria-label":"My Polls",checked:o.value==="polls",onChange:e[0]||(e[0]=r=>o.value="polls")},null,40,nt),t("div",at,[c.value?(l(),n("div",rt,[...e[6]||(e[6]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):i.value.length===0?(l(),n("div",it,[e[8]||(e[8]=t("p",{class:"text-lg mb-4"},"You haven't created any polls yet",-1)),f(x,{to:"/create",class:"btn btn-primary"},{default:h(()=>[...e[7]||(e[7]=[v("Create Your First Poll",-1)])]),_:1})])):(l(),n("div",dt,[(l(!0),n(w,null,_(i.value,r=>(l(),C(W,{key:r.id,poll:r,"show-actions":!0,onEdit:M,onDelete:P},null,8,["poll"]))),128))]))]),t("input",{type:"radio",name:"dashboard_tabs",role:"tab",class:"tab","aria-label":"My Votes",checked:o.value==="votes",onChange:e[1]||(e[1]=r=>o.value="votes")},null,40,ct),t("div",ut,[c.value?(l(),n("div",pt,[...e[9]||(e[9]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):p.value.length===0?(l(),n("div",vt,[...e[10]||(e[10]=[t("p",{class:"text-lg"},"You haven't voted on any polls yet",-1)])])):(l(),n("div",bt,[t("table",ht,[e[12]||(e[12]=t("thead",null,[t("tr",null,[t("th",null,"Poll"),t("th",null,"Date"),t("th",null,"Your Vote"),t("th")])],-1)),t("tbody",null,[(l(!0),n(w,null,_(p.value,r=>(l(),n("tr",{key:r.id},[t("td",null,[f(x,{to:`/poll/${r.poll_id}`,class:"link link-primary"},{default:h(()=>[v(d(r.poll_title),1)]),_:2},1032,["to"]),r.poll_location?(l(),n("div",mt,d(r.poll_location),1)):b("",!0)]),t("td",null,d(V(r.start_time)),1),t("td",null,[t("span",{class:B({"badge badge-success":r.response==="yes","badge badge-error":r.response==="no","badge badge-warning":r.response==="maybe"})},d(r.response.toUpperCase()),3)]),t("td",null,[f(x,{to:`/poll/${r.poll_id}`,class:"btn btn-ghost btn-sm"},{default:h(()=>[...e[11]||(e[11]=[v("View",-1)])]),_:1},8,["to"])])]))),128))])])]))])])])}}};export{gt as default};
