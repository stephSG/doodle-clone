import{u as N,o as U,a as u,c,b as s,s as i,t as m,l as k,f as v,v as w,j as f,e as S,h as _,n as D}from"./index-BzyAT-xv.js";import{u as F}from"./ui-BoShRpqK.js";const B={class:"max-w-2xl mx-auto space-y-6"},E={class:"card bg-base-100 shadow-xl"},M={class:"card-body"},T={class:"flex items-center gap-4 mb-6"},q={class:"avatar"},j={class:"w-24 rounded-full"},O=["src"],R={class:"text-2xl font-bold"},Z={class:"text-base-content/70"},$={class:"badge badge-ghost mt-1"},z={class:"form-control"},G={class:"form-control"},H=["disabled"],I={key:0,class:"loading loading-spinner"},J={key:0,class:"card bg-base-100 shadow-xl"},K={class:"card-body"},L={class:"form-control"},Q={class:"form-control"},W={key:0,class:"alert alert-error"},X=["disabled"],Y={key:0,class:"loading loading-spinner"},ts={__name:"ProfileView",setup(ss){D();const a=N(),p=F(),o=_(!1),b=_(""),l=_({name:"",email:""}),r=_({old_password:"",new_password:""});U(()=>{var t,e;l.value={name:((t=a.user)==null?void 0:t.name)||"",email:((e=a.user)==null?void 0:e.email)||""}});async function V(){var t,e;o.value=!0;try{await a.updateProfile(l.value.name,l.value.email),p.success("Profile updated successfully!")}catch(d){p.error(((e=(t=d.response)==null?void 0:t.data)==null?void 0:e.error)||"Failed to update profile")}finally{o.value=!1}}async function C(){var t,e;o.value=!0,b.value="";try{await a.changePassword(r.value.old_password,r.value.new_password),p.success("Password changed successfully!"),r.value={old_password:"",new_password:""}}catch(d){b.value=((e=(t=d.response)==null?void 0:t.data)==null?void 0:e.error)||"Failed to change password"}finally{o.value=!1}}function A(){confirm("Are you sure you want to delete your account? This action cannot be undone.")&&p.info("Account deletion will be implemented soon")}return(t,e)=>{var d,y,g,x,h,P;return u(),c("div",B,[e[13]||(e[13]=s("h1",{class:"text-3xl font-bold"},"Profile",-1)),s("div",E,[s("div",M,[s("div",T,[s("div",q,[s("div",j,[s("img",{src:((d=i(a).user)==null?void 0:d.avatar)||`https://api.dicebear.com/7.x/avataaars/svg?seed=${(y=i(a).user)==null?void 0:y.name}`},null,8,O)])]),s("div",null,[s("h2",R,m((g=i(a).user)==null?void 0:g.name),1),s("p",Z,m((x=i(a).user)==null?void 0:x.email),1),s("div",$,m(((h=i(a).user)==null?void 0:h.provider)||"email"),1)])]),s("form",{onSubmit:k(V,["prevent"]),class:"space-y-4"},[s("div",z,[e[4]||(e[4]=s("label",{class:"label"},[s("span",{class:"label-text"},"Name")],-1)),v(s("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>l.value.name=n),type:"text",class:"input input-bordered"},null,512),[[w,l.value.name]])]),s("div",G,[e[5]||(e[5]=s("label",{class:"label"},[s("span",{class:"label-text"},"Email")],-1)),v(s("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>l.value.email=n),type:"email",class:"input input-bordered"},null,512),[[w,l.value.email]])]),s("button",{type:"submit",class:"btn btn-primary",disabled:o.value},[o.value?(u(),c("span",I)):f("",!0),e[6]||(e[6]=S(" Save Changes ",-1))],8,H)],32)])]),((P=i(a).user)==null?void 0:P.provider)==="email"?(u(),c("div",J,[s("div",K,[e[10]||(e[10]=s("h2",{class:"card-title"},"Change Password",-1)),s("form",{onSubmit:k(C,["prevent"]),class:"space-y-4"},[s("div",L,[e[7]||(e[7]=s("label",{class:"label"},[s("span",{class:"label-text"},"Current Password")],-1)),v(s("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>r.value.old_password=n),type:"password",class:"input input-bordered",required:""},null,512),[[w,r.value.old_password]])]),s("div",Q,[e[8]||(e[8]=s("label",{class:"label"},[s("span",{class:"label-text"},"New Password")],-1)),v(s("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>r.value.new_password=n),type:"password",class:"input input-bordered",minlength:"8",required:""},null,512),[[w,r.value.new_password]])]),b.value?(u(),c("div",W,[s("span",null,m(b.value),1)])):f("",!0),s("button",{type:"submit",class:"btn btn-warning",disabled:o.value},[o.value?(u(),c("span",Y)):f("",!0),e[9]||(e[9]=S(" Change Password ",-1))],8,X)],32)])])):f("",!0),s("div",{class:"card bg-base-100 shadow-xl border border-error/20"},[s("div",{class:"card-body"},[e[11]||(e[11]=s("h2",{class:"card-title text-error"},"Danger Zone",-1)),e[12]||(e[12]=s("p",{class:"text-sm text-base-content/70"},"Once you delete your account, there is no going back. Please be certain.",-1)),s("button",{onClick:A,class:"btn btn-error btn-outline"}," Delete Account ")])])])}}};export{ts as default};
